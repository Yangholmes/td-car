var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[d]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var d=0;return $jscomp.iteratorPrototype(function(){return d<a.length?{done:!1,value:a[d++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var d=a[Symbol.iterator];return d?d.call(a):$jscomp.arrayIterator(a)};$jscomp.findInternal=function(a,d,c){a instanceof String&&(a=String(a));for(var b=a.length,f=0;f<b;f++){var e=a[f];if(d.call(c,e,f,a))return{i:f,v:e}}return{i:-1,v:void 0}};
$jscomp.polyfill=function(a,d,c,b){if(d){c=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var f=a[b];f in c||(c[f]={});c=c[f]}a=a[a.length-1];b=c[a];d=d(b);d!=b&&null!=d&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6-impl","es3");$(function(){tdCarInit()});
var _car={},tdCarInit=function(){$.ajax({url:"server/reservation/application-init.php",method:"GET",dataType:"json",data:"keyword=yangholmes",error:function(a,d,c){console.log(a)},success:function(a,d,c){0==a.error?(_car=a.records,tdFormView(),tdFormData(),tdFormController()):$.td$.tdAlert("\u8f66\u8f86\u521d\u59cb\u5316\u5931\u8d25\n\u8bf7\u91cd\u8bd5")}})},tdFormView=function(){/[Aa]ndroid/.test(navigator.userAgent)&&($("div.td-form-button").css("position","fixed").css("bottom","0"),$("div.td-form-field:nth-last-child(2)").css("margin-bottom",
"calc( 3em + 1em )"))},tdFormData=function(a){for(var d=$("ul.td-form-comb-img-text-list"),c=0;c<_car.length;c++){a=_car[c];for(var b=$('<li class="td-form-comb-img-text-item"><div class="td-form-comb-img-text-item-img"><img src="" ></div><div class="td-form-comb-img-text-item-text"></div><div class="td-form-field-detail fa fa-hand-pointer-o"></div></li><div class="td-form-comb-img-text-item-detial" id=""><div class="td-car-info"><div>\u8f66\u724c\u53f7\uff1a<span class="td-car-info-plate-number"></span></div><div>\u5ea7\u4f4d\u6570\uff1a<span class="td-car-info-seating"></span></div></div><table class="td-car-reservation"><tbody><tr><td class="td-car-reservation-data">\u8fd1\u65e5\u5df2\u7ea6</td><td class="td-car-reservation-time"></td></tr></tbody></table></div>'),
f=[],e=$jscomp.makeIterator(a.reservation),g=e.next();!g.done;g=e.next())g=g.value,f.push(g["schedule-start"]+"~"+g["schedule-end"]);b.eq(0).attr("id","td-car-item-"+a.carid);b.eq(1).attr("id","td-car-detail-"+a.carid);b.find("img").attr("src",a.imageSrc);b.find(".td-form-comb-img-text-item-text").html(a.model);b.find(".td-car-info-plate-number").html(a.plateNumber);b.find(".td-car-info-seating").html(a.seating);b.find(".td-car-reservation-time").html(f.join(" "));b.appendTo(d)}},tdFormController=
function(){function a(a){a?($(".transparent-mask").addClass("popup").show(),this.addClass("popup").fadeIn(200),$("body").addClass("fixed")):(this.addClass("popup").fadeOut(200),$(".transparent-mask").addClass("popup").hide(),$("body").removeClass("fixed"))}function d(a){b||(a.stopPropagation(),$(a.currentTarget).remove())}function c(a){var e=$(a.currentTarget).children("input"),b=$(a.currentTarget).find("ul li input");a=[];for(var b=$jscomp.makeIterator(b.toArray()),c=b.next();!c.done;c=b.next())value=
c.value,a.push(JSON.parse(value.value));e.val(JSON.stringify(a))}var b=!1;$("body").on("touchstart",function(a){b=!1});$("body").on("touchmove",function(a){b=!0});$(".td-form-datetime-picker input").on("focus",function(a){b||(a.stopPropagation(),$(a.currentTarget).blur(),dd.biz.util.datetimepicker({format:"yyyy-MM-dd HH:mm",value:"",onSuccess:function(e){$(a.currentTarget).val(e.value).blur()},onFail:function(){$(a.currentTarget).blur()}}))});$(".td-form-comb").on("touchend",function(e){b||a.call($(e.currentTarget).find("ul"),
!0)});$(".td-form-comb ul li").on("touchend",function(e){if(!b){e.stopPropagation();var g=$(e.currentTarget).parent("ul").prev(".td-form-comb-selected").find(".td-form-comb-item"),c=$(e.currentTarget).html(),d=e.currentTarget.id;g.html(c).attr("id",d).find(".td-form-field-detail").removeClass("fa fa-hand-pointer-o");$(e.currentTarget).parent("ul").prevAll("input").val(d);a.call($(e.currentTarget).parent("ul"))}});$(".td-form-field-detail").on("touchend",function(a){b||(a.stopPropagation(),a=$(a.currentTarget).parent("li").next(".td-form-comb-img-text-item-detial"),
$(".td-form-comb-img-text-item-detial").slideUp(),"none"==a.css("display")&&a.slideDown())});$(".td-form-easy-picker").on("touchend",function(a){b||(a.stopPropagation(),dd.biz.contact.choose({startWithDepartmentId:0,multiple:!1,users:[_user.userid],disabledUsers:[],corpId:_config.corpId,limitTips:"\u6311\u592a\u591a\u5566\uff01",isNeedSearch:!0,title:"\u6311\u4e2a\u4eba\u5457~",local:"false",onSuccess:function(b){$(a.currentTarget).find("output").val(b[0].name);$(a.currentTarget).find("input").val(JSON.stringify(b[0]))},
onFail:function(a){$.td$.tdAlert("\u4f60\u7684\u901a\u4fe1\u5f55\u6253\u4e0d\u5f00\u3002\u3002\u3002")}}))});$(".td-form-approver-picker").on("upload",c).find("ul div.td-form-approver-picker-add").on("touchend",function(a){b||(a.stopPropagation(),dd.biz.contact.choose({startWithDepartmentId:0,multiple:!1,users:[],disabledUsers:[_user.userid],corpId:_config.corpId,limitTips:"\u6311\u592a\u591a\u5566\uff01",isNeedSearch:!0,title:"\u6311\u4e2a\u4eba\u5457~",local:"false",onSuccess:function(b){console.log(b);
var c=$(a.currentTarget).parents(".td-form-approver-picker").find("ul li#admin"),e=$('<li class="td-form-approver-picker-item"><input type="hidden" class="td-form-input-hidden"><div class="td-form-approver-picker-item-avatar fa fa-arrow-right"><img src='+b[0].avatar+'></div><div class="td-form-approver-picker-item-name">'+b[0].name+"</div></li>");e.on("touchend",f).find("input").val(JSON.stringify(b[0]));c.before(e)},onFail:function(a){$.tdAlert("\u4f60\u7684\u901a\u4fe1\u5f55\u6253\u4e0d\u5f00\u3002\u3002\u3002")}}))});
var f=function(a){b||(a.stopPropagation(),$(a.currentTarget).remove())};$(".td-form-cc-picker").on("upload",c).find("ul div.td-form-cc-picker-add").on("touchend",function(a){b||(a.stopPropagation(),dd.biz.contact.choose({startWithDepartmentId:0,multiple:!1,users:[],disabledUsers:[_user.userid],corpId:_config.corpId,limitTips:"\u6311\u592a\u591a\u5566\uff01",isNeedSearch:!0,title:"\u6311\u4e2a\u4eba\u5457~",local:"false",onSuccess:function(b){var c=$(a.currentTarget).parents(".td-form-cc-picker").find("ul div.td-form-cc-picker-add"),
e=$('<li class="td-form-cc-picker-item"><input type="hidden" class="td-form-input-hidden"><div class="td-form-cc-picker-item-avatar"><img src='+b[0].avatar+'></div><div class="td-form-cc-picker-item-name">'+b[0].name+"</div></li>");e.on("touchend",d).find("input").val(JSON.stringify(b[0]));c.before(e)},onFail:function(a){$.tdAlert("\u4f60\u7684\u901a\u4fe1\u5f55\u6253\u4e0d\u5f00\u3002\u3002\u3002")}}))});$(".td-form-button .td-button").on("touchstart",function(a){$(".td-form-approver-picker").trigger("upload");
$(".td-form-cc-picker").trigger("upload");$("input#applicant").val(JSON.stringify({avatar:_user.avatar,emplId:_user.userid,name:_user.name}));var b=$("form");a=new FormData(b[0]);for(var b=b.find("*[required]"),b=$jscomp.makeIterator(b),c=b.next();!c.done;c=b.next())if(field=c.value,!field.value)return $.tdAlert($(field).prev("label").css("color","red").animate({opacity:0},500,function(){$(this).css({opacity:"1",color:"black"})}).html()+"\u5fc5\u586b\u54e6~"),!1;$.ajax({url:"server/reservation/apply.php",
type:"POST",data:a,dataType:"json",processData:!1,contentType:!1,cache:!1,beforeSend:function(){dd.device.notification.showPreloader({text:"\u6b63\u5728\u4f7f\u52b2\u63d0\u4ea4\u7533\u8bf7...",showIcon:!0,onSuccess:function(a){},onFail:function(a){}})},success:function(a,b,c){dd.device.notification.hidePreloader({onSuccess:function(a){},onFail:function(a){}});0==a.error?(localStorage.setItem(a.records.resid,JSON.stringify(a.records)),dd.device.notification.alert({message:"\u5df2\u7ecf\u53d1\u9001\u901a\u77e5\u4e86~\n\u6ce1\u676f\u8336\u7b49\u9886\u5bfc\u5ba1\u6279\u5427\uff01",
title:"\u606d\u559c\uff01\u63d0\u4ea4\u6210\u529f",buttonName:"\u597d\uff01",onSuccess:function(){},onFail:function(a){}}),window.location.href="page/approval.html?resid="+a.records.resid):$.tdAlert(a.errorMsg)},error:function(a,b,c){dd.device.notification.hidePreloader({onSuccess:function(a){},onFail:function(a){}});$.tdAlert("\u7533\u8bf7\u5931\u8d25\uff01T.T")}})});$(".transparent-mask").on("touchend",function(a){$(".popup").fadeOut(200);$("body").removeClass("fixed")});$("body").on("touchmove",
function(a){console.log(a)})};
