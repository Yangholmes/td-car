var _user={},_config=_config;dd.config({agentId:_config.agentId[0],corpId:_config.corpId[0],timeStamp:_config.timeStamp,nonceStr:_config.nonceStr,signature:_config.signature,type:0,jsApiList:"runtime.info biz.contact.choose device.notification.confirm device.notification.alert device.notification.prompt biz.ding.post biz.util.openLink ui.pullToRefresh.enable ui.pullToRefresh.stop biz.util.openLink biz.navigation.setLeft biz.navigation.setTitle biz.navigation.setRight".split(" ")});
dd.ready(function(){dd.runtime.info({onSuccess:function(a){console.log("runtime info: "+JSON.stringify(a))},onFail:function(a){console.log("fail: "+JSON.stringify(a))}});dd.runtime.permission.requestAuthCode({corpId:_config.corpId[0],onSuccess:function(a){console.log("\u5fae\u5e94\u7528\u514d\u767b\u6388\u6743\u7801: ",a);$.ajax({url:"server/verification/get-user-info.php?access_token="+_config.accessToken+"&code="+a.code,method:"GET",dataType:"json",success:function(a){console.log(a);_user=a},error:function(){}})},
onFail:function(a){console.log("\u5fae\u5e94\u7528\u514d\u767b\u6388\u6743\u7801, \u9519\u8bef: ",a)}});dd.ui.pullToRefresh.disable();dd.biz.navigation.setTitle({title:"\u901a\u5bfc\u7528\u8f66",onSuccess:function(a){console.log(a)},onFail:function(a){console.log(JSON.stringify(a))}});dd.biz.navigation.setMenu({items:[{id:"2",text:"\u8f66\u7684\u7ba1\u7406"},{id:"3",text:"\u6dfb\u52a0\u8f66\u8f86"}],onSuccess:function(a){switch(a.id){case "1":$.tdAlert("\u5373\u5c06\u63a8\u51fa\n\u656c\u8bf7\u671f\u5f85");
break;case "2":dd.biz.util.openLink({url:"http://www.gdrtc.org/car/page/car.html?userid="+_user.userid,onSuccess:function(a){},onFail:function(){}});break;case "3":if(!_user.admin_level)return $.tdAlert("\u8fd9\u4e2a\u64cd\u4f5c\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650"),!1;dd.biz.util.openLink({url:"http://www.gdrtc.org/car/page/car-add.html?userid="+_user.userid,onSuccess:function(a){},onFail:function(){}})}},onFail:function(a){$.tdAlert(a)}})});
dd.error(function(a){console.log("\u9519\u8bef\u4fe1\u606f: "+JSON.stringify(a));$.tdAlert("\u9519\u8bef\u4fe1\u606f: "+JSON.stringify(a))});
