var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var c=a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var g=a[e];if(c.call(b,g,e,a))return{i:e,v:g}}return{i:-1,v:void 0}};
$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6-impl","es3");$(function(){tdCarInit()});
var _car=[],tdCarInit=function(){$.ajax({url:"server/reservation/application-init.php",method:"GET",dataType:"json",data:"keyword=yangholmes",error:function(a,c,b){},success:function(a,c,b){0==a.error?(_car=a.records,tdFormView(),tdFormData(),tdFormController()):$.tdAlert("\u8f66\u8f86\u521d\u59cb\u5316\u5931\u8d25\n\u8bf7\u91cd\u8bd5")}})},tdFormView=function(){/[Aa]ndroid/.test(navigator.userAgent)&&($("div.td-form-button").css("position","fixed").css("bottom","0"),$("div.td-form-field:nth-last-child(2)").eq(-1).css("margin-bottom",
"calc( 3em + 1em )"))},tdFormData=function(a){var c=$("ul.td-form-comb-img-text-list");_car.map(function(a,d,e){d=$('<li class="td-form-comb-img-text-item"><div class="td-form-comb-img-text-item-img"><img src="" ></div><div class="td-form-comb-img-text-item-text"></div><div class="td-form-field-detail fa fa-hand-pointer-o"></div></li><div class="td-form-comb-img-text-item-detial" id=""><div class="td-car-info"><div>\u8f66\u724c\u53f7\uff1a<span class="td-car-info-plate-number"></span></div><div>\u5ea7\u4f4d\u6570\uff1a<span class="td-car-info-seating"></span></div></div><table class="td-car-reservation"><tbody><tr><td class="td-car-reservation-data">\u8fd1\u65e5\u5df2\u7ea6</td><td class="td-car-reservation-time"></td></tr></tbody></table></div>');
var b=[];a.reservation.map(function(a){b.push(a["schedule-start"]+"~"+a["schedule-end"])});d.eq(0).attr("id","td-car-item-"+a.carid);d.eq(1).attr("id","td-car-detail-"+a.carid);d.find("img").attr("src",a.imageSrc);d.find(".td-form-comb-img-text-item-text").html(a.model);d.find(".td-car-info-plate-number").html(a.plateNumber);d.find(".td-car-info-seating").html(a.seating);d.find(".td-car-reservation-time").html(b.join(" "));d.appendTo(c)})},tdFormController=function(){function a(a){a?($(".transparent-mask").addClass("popup").show(),
this.addClass("popup").fadeIn(200),$("body").addClass("fixed")):(this.addClass("popup").fadeOut(200),$(".transparent-mask").addClass("popup").hide(),$("body").removeClass("fixed"))}function c(a){e||(a.stopPropagation(),$(a.currentTarget).remove())}function b(a,h,b,k,c){dd.biz.contact.choose({startWithDepartmentId:a,multiple:h,users:b,disabledUsers:k,corpId:_config.corpId,limitTips:"\u6311\u592a\u591a\u5566\uff01",isNeedSearch:!0,title:"\u6311\u4e2a\u4eba\u5457~",local:"false",onSuccess:function(a){c(a)},
onFail:function(a){$.tdAlert("\u975e\u5e38\u62b1\u6b49\uff01\n\u60a8\u7684\u901a\u4fe1\u5f55\u6253\u4e0d\u5f00\u3002\u3002\u3002")}})}function d(a){var f=$(a.currentTarget).children("input"),b=$(a.currentTarget).find("ul li input");a=[];for(var b=$jscomp.makeIterator(b.toArray()),c=b.next();!c.done;c=b.next())value=c.value,a.push(JSON.parse(value.value));f.val(JSON.stringify(a))}var e=!1;$("body").on("touchstart",function(a){e=!1});$("body").on("touchmove",function(a){e=!0});$(".td-form-datetime-picker input").on("focus",
function(a){e||(a.stopPropagation(),$(a.currentTarget).blur(),dd.biz.util.datetimepicker({format:"yyyy-MM-dd HH:mm",value:"",onSuccess:function(f){$(a.currentTarget).val(f.value).blur()},onFail:function(){$(a.currentTarget).blur()}}))});$(".td-form-comb").on("touchend",function(f){e||a.call($(f.currentTarget).find("ul"),!0)});$(".td-form-comb ul li").on("touchend",function(f){if(!e){f.stopPropagation();var b=$(f.currentTarget).parent("ul").prev(".td-form-comb-selected").find(".td-form-comb-item"),
c=$(f.currentTarget).html(),d=f.currentTarget.id;b.html(c).attr("id",d).find(".td-form-field-detail").removeClass("fa fa-hand-pointer-o");$(f.currentTarget).parent("ul").prevAll("input").val(d);a.call($(f.currentTarget).parent("ul"))}});$(".td-form-field-detail").on("touchend",function(a){e||(a.stopPropagation(),a=$(a.currentTarget).parent("li").next(".td-form-comb-img-text-item-detial"),$(".td-form-comb-img-text-item-detial").slideUp(),"none"==a.css("display")&&a.slideDown())});$(".td-form-easy-picker").on("touchend",
function(a){e||(a.stopPropagation(),b(0,!1,[_user.userid],[],function(b){$(a.currentTarget).find("output").val(b[0].name);$(a.currentTarget).find("input").val(JSON.stringify(b[0]))}))});$(".td-form-approver-picker").on("upload",d).find("ul div.td-form-approver-picker-add").on("touchend",function(a){e||(a.stopPropagation(),b(0,!1,[],[_user.userid],function(b){if(b[0].emplId==_user.userid)return $.tdAlert("\u4e0d\u80fd\u591f\u81ea\u5df1\u5ba1\u6279\u81ea\u5df1\u54e6~"),!1;var c=$(a.currentTarget).parents(".td-form-approver-picker").find("ul li#admin"),
d=$('<li class="td-form-approver-picker-item"><input type="hidden" class="td-form-input-hidden"><div class="td-form-approver-picker-item-avatar fa fa-arrow-right"><img src='+b[0].avatar+'></div><div class="td-form-approver-picker-item-name">'+b[0].name+"</div></li>");d.on("touchend",g).find("input").val(JSON.stringify(b[0]));c.before(d)}))});var g=function(a){e||(a.stopPropagation(),$(a.currentTarget).remove())};$(".td-form-cc-picker").on("upload",d).find("ul div.td-form-cc-picker-add").on("touchend",
function(a){e||(a.stopPropagation(),b(0,!1,[],[_user.userid],function(b){if(b[0].emplId==_user.userid)return $.tdAlert("\u4e0d\u80fd\u591f\u6284\u9001\u7ed9\u81ea\u5df1\u54e6~"),!1;var d=$(a.currentTarget).parents(".td-form-cc-picker").find("ul div.td-form-cc-picker-add"),e=$('<li class="td-form-cc-picker-item"><input type="hidden" class="td-form-input-hidden"><div class="td-form-cc-picker-item-avatar"><img src='+b[0].avatar+'></div><div class="td-form-cc-picker-item-name">'+b[0].name+"</div></li>");
e.on("touchend",c).find("input").val(JSON.stringify(b[0]));d.before(e)}))});$(".td-form-button .td-button").on("touchstart",function(a){$(".td-form-approver-picker").trigger("upload");$(".td-form-cc-picker").trigger("upload");$("input#applicant").val(JSON.stringify({avatar:_user.avatar,emplId:_user.userid,name:_user.name}));var b=$("form");a=new FormData(b[0]);for(var b=b.find("*[required]"),b=$jscomp.makeIterator(b),c=b.next();!c.done;c=b.next())if(field=c.value,!field.value)return $.tdAlert($(field).prev("label").css("color",
"red").animate({opacity:0},500,function(){$(this).css({opacity:"1",color:"black"})}).html()+"\u5fc5\u586b\u54e6~"),!1;$.ajax({url:"server/reservation/apply.php",type:"POST",data:a,dataType:"json",processData:!1,contentType:!1,cache:!1,beforeSend:function(){dd.device.notification.showPreloader({text:"\u6b63\u5728\u4f7f\u52b2\u63d0\u4ea4\u7533\u8bf7...",showIcon:!0,onSuccess:function(a){},onFail:function(a){}})},success:function(a,b,c){dd.device.notification.hidePreloader({onSuccess:function(a){},onFail:function(a){}});
0==a.error?(localStorage.setItem(a.records.resid,JSON.stringify(a.records)),dd.device.notification.alert({message:"\u5df2\u7ecf\u53d1\u9001\u901a\u77e5\u4e86~\n\u6ce1\u676f\u8336\u7b49\u9886\u5bfc\u5ba1\u6279\u5427\uff01",title:"\u606d\u559c\uff01\u63d0\u4ea4\u6210\u529f",buttonName:"\u597d\uff01",onSuccess:function(){},onFail:function(a){}}),window.location.href="page/approval.html?resid="+a.records.resid):$.tdAlert(a.errorMsg)},error:function(a,b,c){dd.device.notification.hidePreloader({onSuccess:function(a){},
onFail:function(a){}});$.tdAlert("\u7533\u8bf7\u5931\u8d25\uff01T.T")}})});$(".transparent-mask").on("touchend",function(a){$(".popup").fadeOut(200);$("body").removeClass("fixed")});$("body").on("touchmove",function(a){})};
